# Generated by ChatGPT
# Prompt: Convert bmp images to png using opencv-python, give me the code

import cv2
import os

def bmp2png(input_folder, output_folder=None, inplace=False, replace=False):
    """
    Converts all BMP images in the input folder to PNG format.

    Args:
        input_folder (str): Path to the folder containing BMP images.
        output_folder (str, optional): Path to the folder for saving PNG images. Ignored if inplace=True.
        inplace (bool, optional): If True, replaces the BMP images with PNG in the same folder. Defaults to False.
        replace (bool, optional): If True, overwrites existing PNG files. Defaults to False.
    """
    # Determine the output folder
    if inplace:
        output_folder = input_folder
    elif output_folder is None:
        raise ValueError("output_folder must be specified if inplace is False.")

    # Create the output folder if it doesn't exist
    os.makedirs(output_folder, exist_ok=True)

    # Iterate through all files in the input folder
    for filename in os.listdir(input_folder):
        if filename.endswith('.bmp'):
            # Construct full file paths
            input_path = os.path.join(input_folder, filename)
            output_filename = os.path.splitext(filename)[0] + '.png'
            output_path = os.path.join(output_folder, output_filename)

            # Skip if the PNG file already exists and replace is False
            if not replace and os.path.exists(output_path):
                print(f"Skipping {output_filename} as it already exists.")
                continue

            # Read the BMP image
            image = cv2.imread(input_path)
            if image is None:
                print(f"Error: Could not read {input_path}")
                continue

            # Write the image as PNG
            cv2.imwrite(output_path, image)
            print(f"Converted {filename} to {output_path}")

            # Remove the original BMP file if inplace is True
            if inplace:
                os.remove(input_path)

# Example usage
script_dir = os.path.dirname(os.path.abspath(__file__))
input_folder = os.path.join(script_dir, "../annotations_coco")
output_folder = os.path.join(script_dir, "../annotations_coco_png")

# Call the function with desired flags
bmp2png(input_folder, output_folder, inplace=False, replace=False)
